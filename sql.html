<!DOCTYPE HTML>

<html>
	<head>
		<title>SQL Database with HTML and JavaScript</title>
		<meta charset="utf-8" />
        <meta name="viewport" content="user-scalable=no,width=device-width" />  
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />       
		<link rel="stylesheet" href="assets/css/main.css" />
        <script type="text/javascript" src="assets/js/jquery.min.js"></script>
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<div class="logo">
							<span class="icon fa-gem"></span>
							<!-- <span class="image main"><img src="images/bubbles.gif" alt="" /></span> -->
						
						<!-- Header Title	 -->
						</div>
						<div class="content">
							<div class="inner">
								<h1>SQL Database</h1>
								</p>
							</div>
						</div>

                        <!-- SQL database -->
                        <div class="container">

                            <div class="row">
                                <form>
                                    <fieldset>
                                        <legend>Item</legend>
                                        <input type="text" class="form-control" name="" id="item">

                                        <legend>Quantity</legend>
                                        <input type="text" class="form-control" id="quantity" name="">
                                        <br>
                                        <br>
                                        <button id="insert" class="btn btn-success">Insert</button>
                                        <button id="create" class="btn btn-success">Create Table</button>
                                        <button id="remove" class="btn btn-success">Delete Table</button>
                                        <button id="list" class="btn btn-success">Fetch Record</button>

										<hr>
										<h3>Record</h3>
										<table class="table table-bordered table-hover" id="itemlist">
										</table>
										
                                    </fieldset>
                                </form>		
                            </div>
                        </div>


						<!-- Table Creation -->
						<script type="text/javascript">
							var db = openDatabase("itemDB", "1.0", "itemDB", 65535);
							$(function () {

								$("#create").click(function () {
									db.transaction(function (transaction) {
										var sql = "CREATE TABLE items" +
											"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT," +
											"item VARCHAR(100) NOT NULL," +
											"quantity INT(5) NOT NULL";
										transaction.executeSql(sql, undefined,
											function () {
												alert("Table is created successfully");
											}, function () {
												alert("Table is already being created");
											})
									});
								});

								$("#remove").click(function () {
									if (!confrim("Are you sure to delete this table?"
										, "")) return;;
									db.transaction(function (transaction) {
										var sql = "DROP TABLE items";
										transaction.executeSql(sql, undefined,
											function () {
												alert("Table is deleted successfully")
											}, function () {
												alert("Error occured while deleting this table");
											})
									});
								});

								$("#insert").click(function () {
									var item = $("#item").val();
									var qty = $("#quantity").val();
									db.transaction(function (transaction) {
										var sql = "INSERT INTO items(item,quantity)VALUES(?,?)";
										transaction.executeSql(sql, [item, qty],
											function () {
												alert("New item added successfully");
											}, function () {
												alert("Item failed to be added");
											})
									});
								});

								$("#list").click(function () {
									$("#itemlist").children().remove();
									db.transaction(function (transaction) {
										var sql = "SELECT * FROM items ORDER BY id DESC";
										transaction.executeSql(sql, undefined,
											function (transaction, result) {
												if (result.rows.length) {
													for (var i = 0; i < result.rows.length; i++) {
														var row = result.rows.item(i);
														var item = row.item;
														var id = row.id;
														var quantity = row.quantity;
														$("#itemlist").append('<tr><td>' + id + '</td><td>' + item + '</td><td>' + quantity + '</td></tr>');
													}
												} else {
													$("#itemlist").append('<tr><td colespan="3" align="center">No Item Found</td></tr>');
												}
											}, function (transaction, err) {
												alert(err.message);
											})
									});
								});
							});
						</script>
						
						<!-- Bottom Links -->
						<ul class="icons">
							<li><a href="https://www.linkedin.com/in/luke-lorenger/" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li>
							<li><a href="https://github.com/LukeLorenger" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
						</ul>						
					</header>	
			</div>			

		<!-- BG -->
			<div id="bg"></div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
